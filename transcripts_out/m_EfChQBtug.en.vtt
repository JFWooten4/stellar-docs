WEBVTT
Kind: captions
Language: en

00:00:00.000 --> 00:00:59.999 align:start position:0%
hey everyone welcome to the Stellar protocol discussion for may 12 2022. in these meetings we discuss and plan for upcoming changes to versions of the Stellar protocol changes that are necessary to evolve the protocol to meet ecosystem needs I'm just real quick a word on venue you know last week we tried having this discussion in the Stellar developer discord and there were some technical issues so we're back to live streaming this on youtube you know we just don't want to let the technical issues of a platform prevent us from having these discussions so that we can talk about the substance and keep moving forward we may experiment with other venues in the future but you know we'll make sure to stress test platforms

00:01:00.000 --> 00:01:59.999 align:start position:0%
so there's just not technical glitches that prevent the conversation from happening that said we are discussing this week some caps that are related to project jump cannon which is the an announcement that we made earlier this year that we are working to bring smart contracts to Stellar and as part of that there are protocol changes that need to happen it's been a bit different this time because we've sort of modularized those changes into a series of core advancement proposals each of which focuses on a specific aspect or specific type of change that needs to happen to accommodate smart contracts now if you're watching this right now it's a technical discussion so i advise it's a technical discussion so I advise looking at the links in the show notes which are the actual links to the core advancement proposals that we're going to discuss and to the discussions that exist on the Stellar dev mailing list which is where sort of long form question and answers happen in addition to the Stellar debt mailing list there's also the Stellar dev discord and there's a jump cannon and a jump can and dev a jump cannon and a jump can and dev channel in there and anyone can join either of those forums in order to like see the discussion unfold or

00:02:00.000 --> 00:02:59.999 align:start position:0%
participate in the discussion we're doing this in the open so that you know doing this in the open so that you know you can sort of see the work happening or and also so that you can have a voice or and also so that you can have a voice in the changes as we make them so that said there are a number of caps so that said there are a number of caps that are on the table right now that relate to smart contracts into jump cannon and we discussed a few of them last week i think this week we're going last week I think this week we're going to start out by talking about some of the classic smart interoperability questions that remain most of which have to do with cat 48 and cat 49 that are kind of two cat 48 and cat 49 that are kind of two different flavors of how to approach that and as recently as this morning there was some interesting discussion on the mailing list about that and so i think mailing list about that and so I think we start there and i think and I think i don't know john do you want to I don't know john do you want to start honestly i'd rather just let eco start i mean nico posted this huge thing start I mean nico posted this huge thing with a bunch of questions and i responded to it so like it's kind of niko's turn to talk in the sense that I'm the most recent speaker on the thread so maybe we can just kind of go

00:03:00.000 --> 00:03:59.999 align:start position:0%
through and we can try to figure out basically just kind of talk through some of these questions and understand what we're actually talking about and make sure we're on the same page on a variety sure we're on the same page on a variety of different things and if we're not on the same page get on the same page that sounds good wall of text yeah sorry yeah so i guess like maybe i don't yeah so I guess like maybe I don't know like one of the things we can talk about is one of the things we can talk about is actually around compliance because i think that's actually the most important bit that is in there okay I mean like I'm i think we I think we should discuss potentially changing i mean maybe not this time around but like you know that this is like in there's an level of expectation in terms of on the compliance front that i think we compliance front that I think we should maybe adjust even in classic so that we can

00:04:00.000 --> 00:04:59.999 align:start position:0%
make things work for john cannon so like the type of for john cannon so like the type of things I'm talking about here is that both proposals kind of suffer from the same problem so today if you have an asset that you issued on the seller network and you like our version basically we only have like a couple of smart contracts basically on today right like we have emms and the decks those are like the kind of equivalent and today we track if you have like money or any asset locked into a contract it's going to be recovered basically when you your authorization gets revoked and i think this breaks completely in and I think this breaks completely in jump cannon because well that's actually not well if we don't do anything right like because the only thing that gets really revoked is

00:05:00.000 --> 00:05:59.999 align:start position:0%
your trust line like the ground of your trust line like you lose access to your wallet but if you parked your money in some smart contract that is the you know like the i know shady guy you know like the I know shady guy on the corner basically there's no way to enforce anything there so then the question is like well what do we do because if you don't do what do we do because if you don't do anything in both proposals we're basically saying well you know if you want to get around any kind of restrictions just you know send your money to this smart contract over there and then it's like this super mixer or something and then like you can you can't reasonably have enforcement so maybe we can start with that like we can say well that's okay that's the new reality new reality and then my then i would argue that and then my then I would argue that we should just stop doing what we are

00:06:00.000 --> 00:06:59.999 align:start position:0%
doing in classic like or at least say that we are going to stop doing you know recover basically like assets from pools or from our other decks like if you know because that's actually a lot of the overhead that we have today in classic so i'll start with that like i don't i'll start with that like I don't know what people think so i can just start with saying what how so I can just start with saying what how i responded to your question to the same I responded to your question to the same question from the email thread which was basically like this does work in cap 48 and cap 49. you this does work in cap 48 and cap 49. you just might not like the way it works but like all the compliance controls that exist on classic still exist they just don't extend to all the contracts by default so you might recall nico would definitely recall because we spoke about it a lot when we were we spoke about it a lot when we were doing the liquidity pools that we had this discussion about whether we should go back and make people you know revoke trust on revoke authorization on every single liquidity

00:07:00.000 --> 00:07:59.999 align:start position:0%
pool individually or do the whole thing globally and basically like usability for issuers run out what one out over like simplicity of protocol design and we ended up making it so that like and we ended up making it so that like basically you revoke and it just gets everything automatically but both cap 40 and cat 49 just revert back to the hey you have to go and back to the hey you have to go and manually chase everything down mode which is the only mode that is sensible in smart contract land like there's the only possible moods are you have to go and chase everything down yourself or you can do nothing but they're the third mode of it does it but they're the third mode of it does it all automatically is not a feasible solution here but basically the way that you would deal with this in the cap let's talk about the cap 48 or cap 49 world doesn't about the cap 48 or cap 49 world doesn't really matter for the sake of argument so let's just say in cap 48 the way you would do this is like hey the way you would do this is like hey like suppose that i want to evade like suppose that I want to evade authorization stuff and so i send my authorization stuff and so I send my money to some random contract

00:08:00.000 --> 00:08:59.999 align:start position:0%
well you look off chain and you say okay like you look off chain and you say okay like where is this guy been sending his money oh he sent his money to this contract frees that address and the issuer just goes through and kind of freezes everywhere where I'm sending money until they get all their money back so basically like your actions contaminate all the downstream systems and that works fine because at the end of the day in cap 48 all the money is of the day in cap 48 all the money is stored like when money is held by a contract like classic money is held by a contract it's living in a trust line and so you can just use the normal authorization techniques on it or in the cap 49 world there's like the interoperability layer has like the interoperability layer has authorization and you can do the exact same thing you just do it at the contract layer instead of at the inter at the trustline layer at the inter at the trustline layer so you can do this it's just kind of so you can do this it's just kind of annoying but it's not just nothing

00:09:00.000 --> 00:09:59.999 align:start position:0%
so well so the thing is that you can so well so the thing is that you can actually design better protocols that you want like those smart contracts firm compliance you should design a compliance protocol that actually allows to do something a little better than that because like this situation that you're like describing here i mean it's like you're describing here I mean it's like you're shutting down the bank because there's like one guy that you know that doesn't behave and that doesn't sound like I mean I don't think you can like I know i like the smart contract is the bank I like the smart contract is the bank right like it's kind of like that it's an automated thing that holds it's an automated thing that holds assets on behalf of a bunch of people i don't think you can generally do I don't think you can generally do better than that the reason being contracts are mutable and so like suppose that i have some and so like suppose that I have some contract and i claim to comply with your contract and I claim to comply with your you know your compliance protocol right meaning like the you know it's a contract it can hold acid a and acid b contract it can hold acid a and acid b and they claim to control to comply with

00:10:00.000 --> 00:10:59.999 align:start position:0%
both acid as an asset b is compliance protocol and then at some point they decided like you know we don't want to do that and they just redeploy without the compliance controls and now that money is unrecoverable so like the only thing the only recourse the issuer would have against that would be to go and freeze up the bank anyway be to go and freeze up the bank anyway so like yes you can design a protocol that has better properties than that but the fact is that in a world with but the fact is that in a world with anything being mutable you can't really like you can't avoid the need to fall back on that of course as a fallback i back on that of course as a fallback I see that is you know reasonable but if that's the only option it's not the only option in the world you can design whatever you want right but like in the context of classic assets that are authorized if you are saying that the def this kind of default world that we are that they know they had like that we are that they know they had like a bunch of comments on like are we

00:11:00.000 --> 00:11:59.999 align:start position:0%
forcing people to be opted into this new thing that doesn't fit the expectation from people I mean the basically like if we don't opt people in we'll end up in a world where everything is useless because people don't opt in like in a world where we can't like where we in a world where we can't like where we can't assume that people will do anything and that is the world we should assume we live in then basically all the work we've been doing for the last seven years could be a total waste you know like all the anchors we've onboard and stuff if we can't get them to take the actions that would be required it's just like hey we just threw it all out ideally everything just works automatically and we do the same thing and if you want to do something better than the same thing then that's when you have to take action and that's the world I would expect like for example if you don't want this default behavior hey there's an easy solution to that set your asset to auth required and then nobody will be able to send money into the smart contract side of it

00:12:00.000 --> 00:12:59.999 align:start position:0%
and then all you have to do is just and then all you have to do is just deploy your own wrapper and you get whatever functionality you want but that's the action path and since most people don't have author cards that they don't have automatable set they don't have author vocals that they don't have off club backable or whatever the hell that one is called clawback enabled or whatever this the default behavior is what everybody is inheriting anyway all the time right every day I'm talking about specifically yeah like for the mutable stuff i agree we can the mutable stuff I agree we can basically kind of take the same stance that i think we've been taking with that I think we've been taking with claimable balances for example which is you take whatever the current the current statement of the issue is kind of what you inherit right no that's not what I'm proposing at all you're muted oh i don't know you're muted oh I don't know can you not hear me I'm not muted on my can you not hear me I'm not muted on my side there was nothing i can hear there was nothing I can hear i can hear him he said that's not what I can hear him he said that's not what he's proposing at all okay i don't know what I'm proposing is okay I don't know what I'm proposing is you and can you hear me now yes yeah okay what I'm proposing is that you inherit the current state of the

00:13:00.000 --> 00:13:59.999 align:start position:0%
flags whatever they are right that's what I'm saying yeah like not like they don't get frozen like if i not like they don't get frozen like if i go and change my flags i inherit the new go and change my flags I inherit the new flags the way that it works for like authors no but like if you want to yeah but no but like if you want to yeah but no number like well if you wanted to if you were saying I'm right now I'm not earth required and then in future i become art required then in future I become art required well it's kind of too late you're all this stuff is now out in smart and all this stuff is now out in smart and you know out of control basically like oh you have to you're kind of yeah and there's a great solution to that you know what you do you set yourself to author required and then you go and claw back everybody's money like would you really call that a great solution yeah it is a great solution actually the reason i consider it a great the reason I consider it a great solution is because nobody has their flag set so this can happen to you right now anyway basically

00:14:00.000 --> 00:14:59.999 align:start position:0%
like you know like any issuer can come and just freeze up all your assets whenever they want to and just say like hey like you have two options either you are frozen forever or you accept my new terms of service and you basically do a swat you basically do a swat that's it anybody can do that at any time and the thing i want to make happen time and the thing I want to make happen is just have everything that works today just working smart that is like my number one goal but the that is like my number one goal but the thing is i mean going back to this thing is I mean going back to this though like i think it kind of though like I think it kind of breaks everything and smart if you allow people to just kind of like i take the people to just kind of like I take the example of a poo right a trading pool if i change the reserve in some pool if I change the reserve in some random way I'm breaking all the environments of that pool correct and so there are two solutions to that problem both of which i actually laid out in both of which I actually laid out in the email i sent to you the first one is the email I sent to you the first one is to say like hey like assets that aren't frozen as off immutable can't use them basically like you check in advance whether it's good to go and if it's not whether it's good to go and if it's not good to go you can't do it

00:15:00.000 --> 00:15:59.999 align:start position:0%
so in this case it'd be like automutable not off revocable the other option is you actually have a guard in your contract which checks that the balances are what you expect them to be so basically like you track the balances internally there's only two in a liquidity bowl so it's not a big deal and then when you actually start doing work you check like hey like are the balances on chain equal to the balances that i expect if not i know that there that I expect if not I know that there was an external thing frozen and that's basically like a single bad actor poisoning the bank but in that world there's a huge incentive for the owner of the contract to go and resolve the problem to liberate all their other users so well then if they use the user of our well then if they use the user of our contract what do you mean like many of those no what do you mean like many of those no well like what i mean is that well like what I mean is that in many cases the contract like is this thing that you want to lock and that's kind of it there's no like operator right i mean like if you want to live in a I mean like if you want to live in a world where you're using auth required assets and you're taking

00:16:00.000 --> 00:16:59.999 align:start position:0%
multiple people's money you better have an operator because those problems can't always be resolved on chain like there's like the standard liquidity pool token would never like design would never let you escape that situation but that's not the expectation in this web 3 world is that you want to have web 3 world is that you want to have like a like an mm right like you don't want to have like some random operator or like controlling the internals of the mm you might need to like if your contract is if your like if your contract is immutable and you accept the funds and the funds can be frozen then there's just literally no way to resolve your problems without an operator so the solution exactly so that's why like it sounds kind of broken to allow that to happen in the first place i don't think it's broken you should I don't think it's broken you should know better than to do that like the only other option is like the only other option is to prevent that and just say like hey

00:17:00.000 --> 00:17:59.999 align:start position:0%
like these assets are useless that's what i think we should do so that's what I think we should do so you think that usdc should be useless it should be like if there is no yes like you know I'm like it's leslie okay great that's is either you allow people to claw back or like make random changes to your state breaking all environments like you can't write software i mean you have to can't write software I mean you have to know all those environs ahead of time right like what can happen what are the situations that can happen with this one asset that i can accept you can't you have to that I can accept you can't you have to kind of inherit that in every single smart contract because you have to make the assumption that oh yeah somebody can mess with my you know trust lines or whatever like you know the equivalent of trust lines that sounds kind of super weird so let me make a couple statements here me let me make a couple statements here the first statement is like you can write software that doesn't have this

00:18:00.000 --> 00:18:59.999 align:start position:0%
problem because you can have the guards on it the second step everybody needs to put the grounds sure the second statement is that on ethereum usdc is blacklistable I i've read the contract it is very clearly blacklistable in fact i believe clearly blacklistable in fact I believe the term that they use in the contract actually is that it inherits blacklistable so it's right there and the third thing is there are liquidity pools that have that functionality nonetheless that like you know you can go and trade usdc in a liquidity pool so that's an extension to esc 20 then that is blacklistable right yeah it's just additional functionality right but this is like then it goes back to maybe this is like then it goes back to maybe like you know we are not implementing erc20 on the network we're actually implementing something broader than that we have to i don't agree like those contracts the I don't agree like those contracts the interface that those that like unit swap is depending on is the erc20 interface

00:19:00.000 --> 00:19:59.999 align:start position:0%
the other stuff is just that's not true you're saying that if what you do you have a new initial pool with usdc that can like I'm pretty sure like you take if you're attesting is true if you if there's a pool somewhere on ethereum right that has usbc and usbc decides to blacklist the pool or do something crazy with it the pool is now compromised basically it's done i that could be the case we'd have to go I that could be the case we'd have to go and review the code but that could be the case and then there's like potentially a cascading effect right like you know people may have corrupted this as character or something like it basically has all sorts of weird things yeah i think we'd have to go and things yeah I think we'd have to go and confirm whether that's actually the case but i do believe that is possible but like the following statements are true usdc is not authentable

00:20:00.000 --> 00:20:59.999 align:start position:0%
ustc has no flags yet set it is unlikely we will end up in a world where usdc will set any of the flags especially immutable because they'd like to control their future and specifically like they won't set not revocable and we know that because their ethereum one is revocable so like in this world you basically are saying like if we don't want to handle that then usdc should be useless on smart and then i would question whether we and then I would question whether we should do this at all I mean I don't know it sounds complicated to have like the default being like this super complex thing to deal with on the on smart side

00:21:00.000 --> 00:21:59.999 align:start position:0%
I mean maybe but that means that we have to expose more than just the rc20 we might be able to i mean one thing we might be able to I mean one thing we might be able to do is make it so that assets are like we might be able to do the clawback like we might be able to do the clawback inheritance thing because it's a lot easier to deal with frozen than claw back frozen yeah destroys everything yeah well it doesn't again you can put the guards in which do exactly the same thing it's not hard but right but then but it's still the same thing like you cannot use basically any assets useful assets what do you mean sorry you're saying that usdc has no is not immutable so it is not but if we did the clawback inheritance thing it wouldn't really matter you run a contract you can check whether it has clawback enabled and you don't have to do the clawback cards and if you try to do the clawback cards and if you try to make a payment you'll just fail because you're blacklisted

00:22:00.000 --> 00:22:59.999 align:start position:0%
is there a next question we should move on to it's definitely no like the thing that this conversation is really shows that it's going to be very hard for people to write smart contracts that don't break because if we are serious about compliance and if we don't add compliance into like the default thing that we're or like if we don't address this beyond what 48 currently

00:23:00.000 --> 00:23:59.999 align:start position:0%
defines theoretically people are still going to want functionality probably like this for some assets and so they're gonna go and implement them this themselves i guess in a contract and then are we gonna end up in the same and then are we gonna end up in the same situation like you know there are people are gonna write like a liquidity pool that doesn't handle those edge cases just like what john you were pointing out on happens on ethereum but to be clear i don't know that that's but to be clear I don't know that that's true for a fact i suspected it right but true for a fact I suspected it right but i mean like we're going to end up we I mean like we're going to end up we probably end up with something similar where we have the basic erc20 somebody goes and defines a blacklistable or a deny listable interface some people ignore that other people code around it it's i don't know it doesn't really it's I don't know it doesn't really sound like we're actually avoiding the problem by not implementing it in ours we're just we're saying like we're not going to provide that interoperability if we don't

00:24:00.000 --> 00:24:59.999 align:start position:0%
I mean I don't disagree with you like if we don't provide this functionality and people require it they will just build it right so by deciding to build it or not we're not actually changing with the weather whether the problem exists or not we're just saying that we're not going to support interoperability with these features of Stellar assets right so I think what it comes down to i think is that it's like what i was saying like what we it's like what I was saying like what we need to then do is use classic assets as kind of the

00:25:00.000 --> 00:25:59.999 align:start position:0%
testing ground for what are those additional properties that you need to expose so that everybody from day one basically handles those such cases there's like basically no chance we can achieve that i want to emphasize like achieve that I want to emphasize like number like it could be as simple as yeah like exposing the art like some you know something I mean like my argument would be like there's no way to globally handle callback at least like the only thing that's going on I'm not saying I'm not saying handle club like I'm not saying handle club like clawback i think requires its own set of clawback I think requires its own set of protocol like actual api you know like a when i say protocol here i mean like you when I say protocol here I mean like you know what are like the methods that you need to expose as a smart contract in order to support kind of a nice low friction clawback

00:26:00.000 --> 00:26:59.999 align:start position:0%
but i don't think that would be in scope but I don't think that would be in scope in anytime soon like i think there is no basically like I think there is no basically like we don't really support glowback in smart i mean we don't support it as in you I mean we don't support it as in you know if clawback is enabled well first you have to know about it and then it potentially if you if it can be enabled you have to be able to can be enabled you have to be able to handle the situations where it would happen isn't that enough like as long as a contract can detect whether the assets it is interacting with is clawback enabled or sorry if the enabled or sorry if the contracts trust line is callback and they would not the asset then the contract knows whether it can take on that risk on or whether it wants take on that risk on or whether it wants to interact because like we have the same problem with starlight with the payment channels

00:27:00.000 --> 00:27:59.999 align:start position:0%
like payment channels don't work or payment channels are not as safe if the assets can just be clawed back out of the payment channel like the payment it's like undefined you end up in undefined behavior and you know when we worked on that we and you know when we worked on that we said well that's the risk you take if you do multi-asset channels and if you do single asset channels like you just need to work with the issuer so are we saying this is a problem just because we expect people to write immutable contracts where there's no issue that you can go to like there's no issue that you can go to like there's no one you can like talk to about the problem like is that the distinction I mean I think maybe like it would help to have like some concrete like some concrete super concrete examples on the cable because i mean i think what's weird is because I mean I think what's weird is that there's like there's even without clawback enabled there's of course the ultimate clawback which is that someone could say we're not going to honor this asset and we're going to issue some new asset because something went horribly wrong right so you could always just make the issue can always

00:28:00.000 --> 00:28:59.999 align:start position:0%
make the token useless so i think that make the token useless so I think that we're worried about this like this i mean it's not maybe not this I mean it's not maybe not improbable but it's this kind of weird situation where someone kind of does something that is kind of changes the rules but such that we don't believe that the asset is worthless anymore but now we no longer know whom it belongs to now we no longer know whom it belongs to it some somehow like broken the attribution of who owns the asset right like this is what we're worried about like if the asset were worthless okay fine that was the risk we took but if fine that was the risk we took but if like that is still worth something but maybe there's a contract with two units of a and two people who are allowed to claim it and suddenly you've clawed back one and now the semantic says whoever gets their first gets to claim their and the other person doesn't and we think that's unfair or like otherwise could you just like paint some of these like scenarios that we're some of these like scenarios that we're concerned about like concretely what it might look like I mean I think one concrete scenario would be like you have a liquidity pool that's pegged with like that between two usd

00:29:00.000 --> 00:29:59.999 align:start position:0%
like fully collateralized stable coins call them usdt and ustc and let's pretend for the sake of argument whether it's true or not that usdt is in fact it's true or not that usdt is in fact really actually truly collateralized I'm not making a statement whether it is or isn't in this context so let's pretend how about you and usd sure great usdi and usdb and we'll just pretend we know which one's which but and basically like you have this pool and let's say it's got like 100 million usda and 100 million usdb plus or minus epsilon on both sides because maybe the price is actually like 99 cents or 99.9 cents or whatever who cares and then the issuer of usdb is like oh and then the issuer of usdb is like oh actually that was like osama bin laden my bad and gets a call from the us my bad and gets a call from the us government and like revokes 25 million dollars and now the pool and I'm sorry I said revoked i mean clause back 25 million revoked I mean clause back 25 million dollars and now the pool is kind of in dollars and now the pool is kind of in this like super bowl state

00:30:00.000 --> 00:30:59.999 align:start position:0%
well actually well presumably what happened is immediately arbitragers would get in there and suck out a bunch would get in there and suck out a bunch of destroyed meaning sucked out to arbitrage and that's kind of bad your only defense against this or you could either say like hey like i or you could either say like hey like i checked that this asset was clawbackable and like that's a risk you took by putting money into this pool or you can put you can say like hey like or you can put you can say like hey like you can't make a pool if it's cloud-backable or you can have a guard that checks whether the balances are still what those contracts thought let's can we step back from mechanism a let's can we step back from mechanism a second and say like what is it suppose that like what we can do is between any that like what we can do is between any two transactions we can do whatever we want right so like pretend we're god for a second and luke what is the ideal response to this look like so first of all it seems a little is so first of all it seems a little is it the terrorists who have actually invested in the liquidity pool

00:31:00.000 --> 00:31:59.999 align:start position:0%
so it's like what you would really want to do is sort of like revoke the assets to do is sort of like revoke the assets in proportion you'd want to kind of like revoke some the us government can only you know let's say revoke usda not usdb so what you should do is like you should so what you should do is like you should like freeze in proportion to what's been clawed back so that you keep the proportion of assets the same right and ultimately the right thing to do is that the terrorists are not allowed to withdraw their money from liquidity pool and everybody else it kind of is business as usual right i think that's what yeah that's right I think that's what yeah that's what you're doing the current product you know in our classic protocol today yeah exactly which one we have to withdraw like we first withdraw like the pull shares for that individual the pull shares for that individual but i don't know if we want to replicate but I don't know if we want to replicate that behavior okay so can we first figure out what we okay so can we first figure out what we would want in an ideal world and then figure out what whether there are sensible mechanisms that could achieve it well what's your definition of what you want that's what I'm trying to figure out

00:32:00.000 --> 00:32:59.999 align:start position:0%
i mean like you know no i mean like I mean like you know no I mean like what's even like i guess maybe that's what's even like I guess maybe that's what you're asking like what is even a desirable aspect of this exactly like i guess let me describe to you what i would consider like the most ideal possible world great the most ideal possible world would probably be that every contract like imagine you actually care about clawback i don't know if we care about clawback I don't know if we do who cares but let's pretend so focusing on clawback like the most ideal possible world would probably be that every contract implements a like issuer clawback function and basically like the issuer's the only one who can call that whatever you want the issuer to be I'm talking about native like classic assets and the issuer's first point of call is to call that admin function when it wants to do something and if it does that the contract hopefully does the right thing and if the contract doesn't provide that functionality or doesn't do the right thing then the issuer just takes whatever action is necessary in order for them to comply

00:33:00.000 --> 00:33:59.999 align:start position:0%
whatever that means and damn all who suffer that's probably like the best possible world you could achieve so like let's say that that's what we wanted to happen okay so actually before i continue does okay so actually before I continue does anybody have a better world okay so basically we're adding a new method that like you're required to implement or maybe there's a default value but like the sensible way to implement it is that you know you do whatever should happen but like basically your contract gets to react every time funds are clawed back no that's not what I'm saying oh sorry no i guess where is this function defined is it defined on the contract that owns the asset or is it defined on every contract that holds an asset I guess yeah every country could be the whole it has

00:34:00.000 --> 00:34:59.999 align:start position:0%
to be the contract that holds the asset like the pool has to implement that thing yeah so the question is so the thing yeah so the question is we could do this and so the question is we could do this and so the question is like is there a sensible default like do we force everybody to implement this or like you know but then that's like a barrier to like deploying your smart contract because i just like write smart contract because I just like write more code or is there some kind of default like the default is like the contract is frozen until it gets upgraded or something or i don't know upgraded or something or I don't know like i think the default should be you can I think the default should be you can opt out basically of this whole thing like you can basically say i don't want like you can basically say I don't want to deal with assets that have those type of properties because it's you know i see so if you because it's you know I see so if you haven't implemented this function then you just can't hold certain assets that are no i totally don't think this makes any no I totally don't think this makes any sense because i can implement this sense because I can implement this function and just assert that could be my whole implementation that's what i mean so assert basically that's what I mean so assert basically says freeze the smart contract until and you know as soon as any funds have been called back from it

00:35:00.000 --> 00:35:59.999 align:start position:0%
I'm sorry i cut off late yeah so he's put his contract yeah i guess no like i think david is I guess no like I think david is probably right you don't want to kind of have like the like in the case of a pool right you probably don't want to have like an arbitrary amount taken under your feet because this breaks all your environs instead you want to just like what you want that to happen and probably in addition the contract gets completely stopped the default I'm talking about the default yeah so the default is that it should stop the contract but also it should grant someone permission to upgrade the contract or something right i mean you know I mean like basically what we need is like human intervention right like we did this thing assuming that these dollars were fine and suddenly like the rules have completely changed so of

00:36:00.000 --> 00:36:59.999 align:start position:0%
course we could just lock all the assets in perpetuity or we could like you know figure out some way to like you know arbitrate the situation you know which might require human judgment because this wasn't something we just put like a yeah like 20 digits proof of work you know unlock code on it so i want to go back to something that so I want to go back to something that you said david like oh like what you know if you don't define this function then you know you don't support these type of assets i think like we're type of assets I think like we're talking about two different things here like there's contracts deciding if they want to use an asset and they can do that if we an asset and they can do that if we provide a way for them just to read their own trust line like does my trust line have clawback enabled simple function simple flag no but I'm saying like if a contract has any trust line that gets clawed back then there has to be a then clawed back then there has to be a then there's a function to kind of deal with that there's like a car yes so i think that there's like a car yes so I think what we're talking about is hooks or

00:37:00.000 --> 00:37:59.999 align:start position:0%
the idea of to hook into an event that's the idea of to hook into an event that's happening rather than having a rather than having a function that does the thing that needs to happen we just want like a function that notifies the contract this is happening whether you like it or not because you decided to hold a claw backable asset so like once you hold it you can't get out like once you hold it you can't get out of this happening and then you just get told when it happens so contracts don't have to provide that function if they don't care that it happens it'll just happen and the consequences will just be whatever they are but if you care about it and you want to but if you care about it and you want to mutate your internal state maybe or update something then you have the option to do that but i guess what we're anticipating is but I guess what we're anticipating is that there are a bunch of situations where people write contracts without any possible idea like they just can't imagine that usdc would ever like try to claw back their asset and yet you know two years later usdc like sets the claw backable whatever

00:38:00.000 --> 00:38:59.999 align:start position:0%
it's called clawback enabled flag on their account and actually like claws something back right and so basically that though like so clawback is designed so that once you hold once you have a so that once you hold once you have a truss line you can't get enabled so i mean we've already designed around that i think I think the other thing we can do the other thing we can do is you know we can make the sdk or however you're interacting you're writing contracts so that when the account when the contract says I'm willing to hold an asset I'm assuming that we're going to have some way of saying that like on stella like on classic like on Stellar like on classic you have to explicitly say that you're going to allow the outside to be clawbackable and then you know maybe that call fails if you just haven't passed that flag in if the asset is clawbackable like so then coming back I think john like your example then is not so scary because in your example either usda or usdb already had to be have clawback enabled right so is there some other example that's more scary so actually just to be clear

00:39:00.000 --> 00:39:59.999 align:start position:0%
the proposal i wrote the proposal I wrote the like it was actually based off of the current flag so like things could become claw-backable later we don't have to do it like that but they can't become callbackable later for an existing trust line well that's how it's that's how like the current stuff works that's not what my proposal specified at least not cat 49 cap 48 i guess does work like that 49 cap 48 I guess does work like that kind of default it doesn't have to be like that we could make it all work like this just a little extra complexity to deal with some stuff but it might save complexity somewhere else but the thing that I'm like skeptical about here is like the notion of a callback here like you probably don't want to do callbacks callback it could be that like the contract is stuck until someone calls the un the cleanup clawback method or something but my argument would really be like to implement this the whole opposite way

00:40:00.000 --> 00:40:59.999 align:start position:0%
which is basically like hey like we have a strong recommendation for you to implement this function and if you implement it we encourage issuers to use it there is no promise that they will because at the end of the day like if the issuer needs to do something unilaterally they should be able to and since then sure but why should this be up to the issuers like the i guess what I'm saying is like the I guess what I'm saying is like the invocation should be a result of something happening on classic not of the issue or doing some kind of smart contract thing no it definitely has to be a smart contractor thing first of all because definitely should not be the issuer not paying gas to clean up other people's smart contracts who did not like anticipate something who did not like anticipate something being well that raises a problem then because like if i ride my hook my then because like if I ride my hook my callback to use like some obscene amount of gas like who's going to pay for that of gas like who's going to pay for that what that's the point like somebody who

00:41:00.000 --> 00:41:59.999 align:start position:0%
cares about that contract what no oh well you're saying if it's called at a different time I mean at the end of the day like the callback could always fail right even if you implement it and you think it won't fail it could still like for example like consider like a usda usdb liquidity pool right what does a clawback on Stellar do well it returns both assets well what if the other asset you were already frozen well then the operation would fail and so they look like at the end of fail and so they look like at the end of the day like there has to be the support the day like there has to be the support for a unilateral clawback anyway and the contract has to handle that and so like in the world where there is a unilateral clawback we might as well just say that the contract should supply a function and the issuer should call it but you have to deal with it if they but you have to deal with it if they don't anyway if anybody can call this function is that like can anybody call a function

00:42:00.000 --> 00:42:59.999 align:start position:0%
i would say that it would have it should I would say that it would have it should have a guard on the issuer type of thing have a guard on the issuer type of thing so basically it should check like hey like is the person who can call this the like is the person who can call this the person who can call it i mean presumably what it should do I mean presumably what it should do like the function should like examine all the trust lines and if they're all in the expected state not do anything and otherwise clean up the mass yeah i feel like what we're describing yeah I feel like what we're describing is like some general function like we're actually just going a more general function that just is something might be wrong go check your state yeah figure it out if it's not and like yeah figure it out if it's not and like we're not actually talking about callbacks specifically we're more talking about how to get a contract unstuck that gets in a bad state that's not really talking sure yeah that's way harder to try like there's only one if you're in a generically borked state there's only one solution human intervention that's the only possible solution if you're generically borked because in what way are you borked well only a human can determine that unless you've written a program that can analyze the state of all the program of

00:43:00.000 --> 00:43:59.999 align:start position:0%
like all the possible states that you're in and since like that sounds generally hard and like generally not feasible in a gas like research constrained world there's like no hope of that so okay so the distinction of the function you're talking about is that because only the issuer could call this because there's a guard for that me writing a contract i can trust the me writing a contract I can trust the issue we'll only call this if they are in fact doing this thing I'm very clearly saying like there's no protocol specifications here at all the only thing I'm saying is like it is the only thing I'm saying is like it is a recommendation to people who write contracts that they should provide a function that implements clawback if they would like to hold callbackable assets right but as the contract author i need to be thinking about where my I need to be thinking about where my trust lies so if this function is going to mutate the internal state of my contract i i've got to be trusting the issuer to only call it when this is actually happening i don't necessarily know what you I don't necessarily know what you mean like the function should be implemented

00:44:00.000 --> 00:44:59.999 align:start position:0%
in such a way that it leave like it like in such a way that it leave like it like leaves your contract in a same state so like if you want it to only be callable by if you want it to only be callable by the issuer which would be the same thing to do you should check that but you don't have to check that in theory you could let anybody close out on your contract it just sucks you do not want to be called by the issuer right the issuer is not in general going to know about every smart contract using their asset well you want to be you want their asset well you want to be callable by anyone but only do anything if like something unexpected is happening in the state of your trust lines right so you want like a basically you want basically a like a board on board check that's at the beginning of most of your methods right and then you want to clean up the mess method that like anybody can call to like clean up the thing that's causing all the other methods to i think john's function methods to I think john's function the issuer is clawing back from the contracts account and so the issue knows about the contract in this case because they're clawing it back so that's why they know to call that function on

00:45:00.000 --> 00:45:59.999 align:start position:0%
the contract and i mean clearly why did they care like that's not like maybe the issuer only does classic you know like does usdc care about smart like does usdc care about smart contracts like they're there to provide an asset that has a well-defined you know redemption path and like that's fine they're not here to like parse people's smart contracts and spend a bunch of gas doing whatever right so i feel like I feel like what we need to do is just have a way for a people who care about a smart contract to clean up the mess when the smart contracts assumptions about assets are no longer correct or about trust lines which in theory where you know we've been talking about mutable contracts so like even if a contract is in the worst possible state somebody can upload a new version of that contract to fix it only if somebody can actually do so right but like nico protested

00:46:00.000 --> 00:46:59.999 align:start position:0%
against my notion that these contracts would even be mutable if they're mutable there's no problem like in the world where the contracts are immutable and somebody actually has the authority to mute them mutate them whether that is like an issue like not an issue sorry an organization an entity or a person there's no problem the accounts get frozen or the accounts get called back the issuer just you know the owner of that contract just calls up the issuer of the asset and says like hey like how do we asset and says like hey like how do we fix this problem oh this is how we need fix this problem oh this is how we need to mutate the state cool i'll write the function to do that i mean one can function to do that I mean one can imagine you know wanting to set up a contract that you can only change when it gets worked or something like you know maybe there's value for like yes if suddenly like uscc gets called back then i get the ability to upgrade this I get the ability to upgrade this contract but usually i don't want this contract but usually I don't want this ability because like you know the contract should be its own logic that would be easy to write though you could write that contract that's not hard you can do that without any magic at all so

00:47:00.000 --> 00:47:59.999 align:start position:0%
i don't know i feel like we're not I don't know I feel like we're not all talking about the same thing here and i think that's why we're not and I think that's why we're not agreeing on stuff like what kind of clawbacks are there other like types of edge case or edge cases that this would apply to or is that or is it just the club like sorry classic clawbacks a clawback enabled asset that gets the trip that invokes clawback classic clawback right are there other state changes that could happen on classic that would lead to this situation or is this limited to clawbacks I mean like getting frozen would be not as complicated but equally bad so an auth required token where you deauthorize the trust line so there are the other auth flags because it's also like can we just say hey no it's also like can we just say hey no clawback enabled assets in smart contracts can't use them

00:48:00.000 --> 00:48:59.999 align:start position:0%
maybe I mean like here's a way that you could implement this if we wanted that basically like you can only send you can only create a in the cat 48 you can only create a in the cat 48 world you can only create a trust line for a smart contract to an asset that is already going basically like that operation of creating the trust line would fail if you would end up with the clawback enabled flag on your trustline and then you just never end up in this world yeah I think we should just make it like a choice you know you call trust trustline with no options and that's the case it just fails if it's callback enabled or there's like an additional flag or option you can pass that just says like I'm willing to go the potentially unsafe route of having a trust line that's called like

00:49:00.000 --> 00:49:59.999 align:start position:0%
enabled and then at least it's surfaced to the developer like it's in their face it's the same thing that we're talking about with re-entry yeah the surface so they know about it dave david on the context of the cleanup method i think the big issue with the method I think the big issue with the cleanup method is like there are worlds that you can enter where you don't know how to clean up like you don't necessarily know what like suppose that an issue or claws back from your contract do you know why they did that so how do you fix the state of your so how do you fix the state of your contract well I'm thinking like what the cleanup method could do is it could like add a signing key to or somehow like enable the author of the contract to upgrade it for example or like it goes in safe mode or something and then unlock some like a maintenance i think that's one of the I think that's one of the like patterns that some smart contracts have already like you have like even the ones that have like a dial like you have ones that have like a dial like you have you know you can basically go into this

00:50:00.000 --> 00:50:59.999 align:start position:0%
maintenance mode it just takes like a week or something like it's not instant there was a bug a few months ago actually on a i think a bridge protocol actually on a I think a bridge protocol or something where it was not a week it was like a second it was not a week it was like a second instead but yeah i just i don't know personally i just I don't know personally I just feel like we're making this really complicated like at the end of the day i feel like at the end of the day I feel like usability should be front of mind for developers and like if we make this complicated nobody's going to use it and then we failed right so can i say can I say the question is so the point but so the only we would need to have a default for only we would need to have a default for this method right so like we're not saying like everybody has to implement a method but like basically the problem is that like people are going to make assumptions about trust lines and every once in a while these assumptions may like

00:51:00.000 --> 00:51:59.999 align:start position:0%
break you know like a way that would cause like really weird like you know unspecified behavior of the smart contract and so should we have some default thing where like by default the contract like enters maintenance mode or whatever when these assumptions are broken I mean that assumes that we like we impose a maintenance mode onto the entire world and i just don't think we should and I just don't think we should like if you want that behavior well you said assert what happens when an assert fails like are you seriously thinking about having an assert well what i meant about in a search was well what I meant about in a search was like i was actually giving you a like I was actually giving you a pathological case of where what you were proposing wouldn't work for the cleanup oh it's just it just asserts and fails it says nothing you cannot do it it's like oh what what's good did that do you like oh what what's good did that do you right like anybody can like that i for an assert to have an asset for an assert to have an asset you also need to write that condition in the first place right like no I'm saying that's not like a false that's no i see yeah

00:52:00.000 --> 00:52:59.999 align:start position:0%
that's no I see yeah number like even no but like i was even number like even no but like I was even thinking for like you know even if you have like all the you know even if you have like all the defaults and all that stuff like you have to write your environs in a way so that you can handle you can know basically that you are blocked and that sounds kind of not workable well i mean i guess you know to my well I mean I guess you know to my proposal would basically be that anytime a third party like forcibly does something to one of your trust lines you get in a state where someone has to you get in a state where someone has to call this cleanup function if you haven't implemented the cleanup function then like nothing can happen to your contract that just sounds undesirable to me but maybe your contract sounds pretty undesirable too which is that like whoever first like which is like a bunch of arbitragers go in and suck out like all the money that's there by accident no my proposal is just that like if you're a contract developer you should handle it figure out what you're saying you can saying you can but how do we know people are going to

00:53:00.000 --> 00:53:59.999 align:start position:0%
do this right we don't and if they don't do this right we don't and if they don't then they're then like it's the same thing as any other smartphone so when they don't do we want like people to lose money to arbitragers or do we want like the contract to freeze and people have to like debate how to clean up the have to like debate how to clean up the mess what if it can't be cleaned up like mess what if it can't be cleaned up like what if there's nobody who owns the contract that was the case that nico was talking about if nobody owns the contract nobody can clean it up and now the money's just locked up forever well then maybe the default implementation of this function is that it like hands signing authority back to whichever account like created this market what if they don't have a key anymore yeah then everybody loses their money well that's the world that niko was talking about with the contract being immutable like again if the contract is mutable there's just not really a problem here well it is a problem if everybody loses their money no in the world where the contracts are mutable and people can actually perform the mutation i mean mutation I mean there's not really a problem because people can just come through and clean up the mess no sorry they can't clean up the mess

00:54:00.000 --> 00:54:59.999 align:start position:0%
if arbitragers have sucked out a bunch of money that's why you should handle the guarding conditions that you need if you do need them well i feel like we're out of time them well I feel like we're out of time for this discussion right here in person today but it seems like there's a lot i mean i think we just got to keep I mean I think we just got to keep working async on the dev discussion mailing list and on the discord and reconvene here next week i don't and reconvene here next week I don't know i don't know what the next steps know I don't know what the next steps are though i mean like the thing i wanted to I mean like the thing I wanted to say is like i think say is like I think for the first phase of this i think for the first phase of this I think i would do what's kind of what I would do what's kind of what lee was saying which is like we don't support global assets right like if you have to have on right like if you have to have on your trust line basically this for cla for those classic things I'm talking about for the first version you can't even you can't do anything right and then you can deploy a contract basically that uses that and then

00:55:00.000 --> 00:55:59.999 align:start position:0%
in parallel or later we can figure out this global like how can we make clawback work in smart world and then retrofit this to classic I think the main lines of work should be the first one should be like let's go and figure out what happens with these kinds of contracts on ethereum like these problems exist people are doing something that's why they don't though right because the one thing that's different here is that there's this the classic world is going to kind of reach in and mess with the smart contract world in a way that can't happen in ethereum that's not true like i literally told you that usdc has like I literally told you that usdc has an auth revoke function it has revoked like so it has yeah you can revoke i don't know if they have do can revoke I don't know if they have do they have a clawback i don't think so they have a clawback I don't think so because that would be a that's the one that really breaks everything i mean that really breaks everything I mean they both break everything but clawback something more see you next week bye

00:56:00.000 --> 00:56:59.999 align:start position:0%
david i see you next week david I see you next week what people are doing yeah and how they're handling it and then we should resume this but again like I'm like i think it's a favor of keeping it I think it's a favor of keeping it simple i know that there's like the simple I know that there's like the theoretical possibilities in edge cases but i think it's also worth pointing out but I think it's also worth pointing out that i don't know that there are any that I don't know that there are any active clawback enabled assets on in classic right now just fyi i agree with that yeah I agree with that yeah all right see everybody next week
